/*!
* basket.js
* v0.4.0 - 2014-04-04
* http://addyosmani.github.com/basket.js
* (c) Addy Osmani;  License
* Created by: Addy Osmani, Sindre Sorhus, AndrÃ©e Hansson, Mat Scales
* Contributors: Ironsjp, Mathias Bynens, Rick Waldron, Felipe Morais
* Uses rsvp.js, https://github.com/tildeio/rsvp.js
*/
!function(a,b){"use strict";var c=b.head||b.getElementsByTagName("head")[0],d="basket-",e=5e3,f=null,g=function(){if(null===f){f=!1;try{var a=(new Date).getTime();localStorage.setItem("t_"+a,"d_"+a),localStorage.getItem("t_"+a)==="d_"+a&&(localStorage.removeItem("t_"+a),f=!0)}catch(b){}}return f},h=function(){return!1},i=function(){return g()?localStorage:{setItem:h,getItem:h,removeItem:h}},j=function(a){var b=[],c=a.split("/");for(var d in c)"."!==c[d]&&(".."===c[d]?b.pop():b.push(c[d]));return b.join("/")},k=function(a,b){try{return i().setItem(d+a,JSON.stringify(b)),!0}catch(c){if(c.name.toUpperCase().indexOf("QUOTA")>=0){var e,f=[];for(e in i())0===e.indexOf(d)&&f.push(JSON.parse(i()[e]));return f.length?(f.sort(function(a,b){return a.stamp-b.stamp}),basket.remove(f[0].key),k(a,b)):void 0}return}},l=function(a){var b=new RSVP.Promise(function(b,c){var d=new XMLHttpRequest;d.open("GET",a),d.onreadystatechange=function(){4===d.readyState&&(200===d.status?b({content:d.responseText,type:d.getResponseHeader("content-type")}):c(new Error(d.statusText)))},setTimeout(function(){d.readyState<4&&d.abort()},basket.timeout),d.send()});return b},m=function(a){return l(a.url).then(function(b){var c=n(a,b);return k(a.key,c),c})},n=function(a,b){var c=+new Date;return a.data=b.content,a.originalType=b.type,a.type=a.type||b.type,a.stamp=c,a.expire=c+60*(a.expire||e)*60*1e3,a},o=function(a,b){return!a||a.expire-+new Date<0||b.unique!==a.unique||basket.isValidItem&&!basket.isValidItem(a,b)},p=function(a){var b,c,d;if(a.url)return a.url=j(a.url),a.key=a.key||a.url,!a.unique&&basket.checksums[a.url]&&(a.unique=basket.checksums[a.url]),b=basket.get(a.key),a.execute=a.execute!==!1,d=o(b,a),a.live||d?(a.unique&&(a.url+=(a.url.indexOf("?")>0?"&":"?")+"basket-unique="+a.unique),c=m(a),a.live&&!d&&(c=c.then(function(a){return a},function(){return b}))):(b.type=a.type||b.originalType,c=new RSVP.Promise(function(a){a(b)})),c},q=function(a){var d=b.createElement("script");d.defer=!0,d.text=a.data,c.appendChild(d)},r={"default":q},s=function(a){return a.type&&r[a.type]?r[a.type](a):r["default"](a)},t=function(a){a.map(function(a){return a.execute&&s(a),a})},u=function(){var a,b,c=[];for(a=0,b=arguments.length;b>a;a++)c.push(p(arguments[a]));return RSVP.all(c)},v=function(){var a=u.apply(null,arguments),b=this.then(function(){return a}).then(t);return b.thenRequire=v,b};a.basket={require:function(){var a=u.apply(null,arguments).then(t);return a.thenRequire=v,a},synchRequire:function(){var a=Array.prototype.slice.call(Array.isArray(arguments[0])?arguments[0]:arguments),b=a.shift();return b?this.require(b).then(this.synchRequire.bind(this,a)):void 0},remove:function(a){return i().removeItem(d+a),this},get:function(a){var b=i().getItem(d+a);try{return JSON.parse(b||"false")}catch(c){return!1}},clear:function(a){var b,c,e=+new Date;for(b in i())c=b.substr(b.indexOf(d)+d.length),c&&(!a||this.get(c).expire<=e)&&this.remove(c);return this},isValidItem:null,timeout:5e3,checksums:[],addHandler:function(a,b){Array.isArray(a)||(a=[a]),a.forEach(function(a){r[a]=b})},removeHandler:function(a){basket.addHandler(a,void 0)}},basket.clear(!0)}(this,document);
//# sourceMappingURL=dist/basket.min.map
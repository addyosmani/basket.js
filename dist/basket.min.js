/*!
* basket.js
* v0.3.0 - 2012-11-22
* http://addyosmani.github.com/basket.js
* (c) Addy Osmani; MIT License
* Created by: Addy Osmani, Sindre Sorhus, AndrÃ©e Hansson
* Contributors: Ironsjp, Mathias Bynens, Rick Waldron
*/
(function(e,t){"use strict";var n=t.head||t.getElementsByTagName("head")[0],r="basket-",i=[],s=0,o=0,u=[],a=5e3,f=function(e){return{}.toString.call(e)==="[object Function]"},l=function(e,t){var n=new XMLHttpRequest;n.open("GET",e),n.onreadystatechange=function(){n.readyState===4&&n.status===200&&t(n.responseText)},n.send()},c=function(e,t){l(e.url,function(n){var i=d(e,n);localStorage.setItem(r+e.key,JSON.stringify(i)),f(t)&&t(n)})},h=function(e){var r=t.createElement("script");r.defer=!0,r.text=e,n.appendChild(r)},p=function(e,t){var n,r,o,a;if(s>=e)for(n=0;n<i.length;n++){o=i[n];if(!o)continue;i[n]=null,t&&h(o),s++;for(r=n;r<s;r++)a=u[r],f(a)&&(u[r]=null,a())}},d=function(e,t){var n=+(new Date);return e.data=t,e.stamp=n,e.expire=n+(e.expire||a)*60*60*1e3,e},v=function(e){var t=o,n=i.length,r,s=function(r){i[n]=r,p(t,e.execute)};if(!e.url)return;e.key=e.key||e.url,r=basket.get(e.key),e.execute=e.execute!==!1,i[n]=null,!r||r.expire- +(new Date)<0||e.unique!==r.unique?(e.unique&&(e.url+=(e.url.indexOf("?")>0?"&":"?")+"basket-unique="+e.unique),c(e,s)):s(r.data),f(e.wait)&&basket.wait(e.wait)};e.basket={require:function(){var e,t;for(e=0,t=arguments.length;e<t;e++)v(arguments[e]);return this},remove:function(e){return localStorage.removeItem(r+e),this},wait:function(e){return o=i.length-1,f(e)&&(s>o?e():u[o]=e),this},get:function(e){return JSON.parse(localStorage.getItem(r+e))||!1},clear:function(){var e,t=localStorage,n=+(new Date);for(e in t)e.indexOf(r)===0&&delete t[e];return this}}})(this,document);